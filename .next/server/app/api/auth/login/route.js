(()=>{var e={};e.id=7758,e.ids=[7758],e.modules={1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7066:e=>{"use strict";e.exports=require("node:tty")},8834:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>g,routeModule:()=>l,serverHooks:()=>f,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{POST:()=>d});var o=t(96559),i=t(48088),n=t(37719),a=t(32190),u=t(85663),p=t(46766),c=t(79464);async function d(e){let r=await e.json(),t=r.identifier?.toString()||"",s=r.password?.toString()||"";if(!t||!s)return a.NextResponse.json({success:!1,message:"Please enter both email/phone and password.",errors:{identifier:t?void 0:["Required"],password:s?void 0:["Required"]},formData:{identifier:t}},{status:400});let o=await c.z.user.findFirst({where:{OR:[{email:t},{phone:t}]}});if(!o)return a.NextResponse.json({success:!1,message:"Invalid credentials.",errors:{identifier:["User not found"]},formData:{identifier:t}},{status:401});if(!await u.Ay.compare(s,o.password))return a.NextResponse.json({success:!1,message:"Invalid credentials.",formData:{identifier:t}},{status:401});let i=await (0,p.N)({userId:Number(o.id),role:o.role}),n=a.NextResponse.json({success:!0,message:"Login successful.",role:o.role});return n.cookies.set("token",i,{httpOnly:!0,path:"/",sameSite:"lax",maxAge:604800,secure:!0}),n}let l=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\nextjs\\e-commerce-store\\my-app\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:m,serverHooks:f}=l;function g(){return(0,n.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:m})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31421:e=>{"use strict";e.exports=require("node:child_process")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},46766:(e,r,t)=>{"use strict";t.d(r,{J:()=>u,N:()=>a});var s=t(87806),o=t(77412);let i=process.env.JWT_SECRET;if(!i)throw Error("JWT_SECRET is not set in environment variables!");let n=new TextEncoder;async function a(e){return await new s.P({...e,userId:e.userId.toString()}).setProtectedHeader({alg:"HS256",typ:"JWT"}).setExpirationTime("7d").sign(n.encode(i))}async function u(e){try{let{payload:r}=await (0,o.V)(e,n.encode(i));return r}catch{return null}}},48161:e=>{"use strict";e.exports=require("node:os")},51455:e=>{"use strict";e.exports=require("node:fs/promises")},55511:e=>{"use strict";e.exports=require("crypto")},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73024:e=>{"use strict";e.exports=require("node:fs")},76760:e=>{"use strict";e.exports=require("node:path")},77598:e=>{"use strict";e.exports=require("node:crypto")},78335:()=>{},78474:e=>{"use strict";e.exports=require("node:events")},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4243,4553,580,5663,9464],()=>t(8834));module.exports=s})();